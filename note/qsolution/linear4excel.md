# Excel中的线性规划问题  

在学习了橡皮鸭和橡皮鱼的生产之后，想起知乎上某位说起用线性规划买书的事，于是尝试解决。  

ps.为什么不用程序呢？尝试写了，发现并不能保证约束条件都实现。于是罢了。

## 问题描述   

[哪个瞬间让你突然觉得读书真有用？ - 初尔臻的回答 - 知乎](https://www.zhihu.com/question/35720340/answer/64691928)  

> 有一次一个环境院小妹儿在二手书网上买教材，一共十多本，加起来约二百块钱(二手书也不那么便宜啊但是新的更贵)。包邮的规则是酱紫的:满49包邮但是不能超过2kg,不然邮费之高跟书价都差不多  

## 解   

### 1. 模拟数据  

模拟了12本书，重量用0到1的随机数生成，书价用27*rand()生成（这是为了模拟出总价200多、十多本书的情况）  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/72372173.jpg)  

模拟数据如上。  

### 2. 设置表格  

参考这个人的理解：  

> hsby hu 回复 初尔臻（作者）  
我好像明白了。你看是不是这样子的：可变区域为n行四列，n是购书的总数量，约束条件1是每列叉乘价格列>49，约束条件2是每列叉乘重量列<2，目标函数为sumproduct(每列,价格列)。然后可变区域的结果应该是介于0到1的小数。然后取个整，每列代表一个包，列中0表示不买，1表示买。这样每包都包含哪几本书就一目了然了。    

添加列，如下：  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/803023.jpg)  

用这三列表示要或者不要，所以又加了一列：列控制，内容为这三列之和：  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/65518418.jpg)  

添加两行，分别为各组的重量和与价格和：  

重量和：  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/43159738.jpg)  

价格和：  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/48301369.jpg)  

设置目标：  

各组价格之和：  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/75907836.jpg)  

现在整体表格长这样：  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/17322723.jpg)  

### 3. 设置规划  

![](http://7xotr7.com1.z0.glb.clouddn.com/16-5-13/93884757.jpg)  

- 二进制保证非0即1；  
- 和小于等于1保证每一包只出现一次（但似乎不能排除0的情况）；  
- 分包重量小于2；  
- 分包价格大于49；  

试过给二进制组设置和等于1，或者and、or为true或false等，都失败了。设置和等于1的话，出现的小数没法弄，甚至有四个0.25这样的情况（3的话应该是3个0.33）  

选择求解方法为演化，另外两种情况都可能出现0.99等小数。演化则不会。  

## 反思  

似乎问题能否有解是看运气的，反复运行，反复试。  

能否知道所提供数据是否真的有解？  

加入快递费用的话怎么弄？  

是否假设所有旧书在所有店家的售价都统一？对于题主的具体问题来说，这样得到的书未必在同一家店，还是说这些教材价格在不同店铺的价格都是相同的？  

分几包也不一定，比如我模拟出来的数据，确实总价超过200，数量也差不多10多本，但是在分四包时怎么也不能满足所有的条件。